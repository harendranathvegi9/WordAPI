{% extends "frontend/base.html" %}

{% block custom_style %}
{{ style|safe }}
{% endblock %}

{% block custom_include %}
<link rel="stylesheet" media="screen" type="text/css" href="/media/colorpicker.css" />
<script type="text/javascript" src="/media/js/colorpicker.js"></script>
{% endblock %}
{% block page_title %} - TagCloud{% endblock %}

{% block custom_js %}
<script type="text/javascript">
$(document).ready(function() {

    $("#save-box").dialog({
        autoOpen: false,
        width: 350,
        model: true,
        buttons : {
            'Create!' : function() { 
                // check validity of arguments
                // submit the form
                $('#save-form').submit();
            },
            'Cancel' : function() {
                $(this).dialog("close");
            }
        }, 
        close: function() {
            allFields.val('');
        }
    });
    $("#save-cloud").button().click(function() {
        $("#save-box").dialog("open");
    });
});

$('#id_start_color, #id_end_color').ColorPicker({
	onSubmit: function(hsb, hex, rgb, el) {
		$(el).val(hex);
		$(el).ColorPickerHide();
	},
	onBeforeShow: function () {
		alert("hello");
		$(this).ColorPickerSetColor(this.value);
	}
})
.bind('keyup', function(){
	$(this).ColorPickerSetColor(this.value);
});


</script>
{% endblock %}

{% block content %}
<div id="save-box">
<form id="save-form" action="save" method="POST">
{% csrf_token %}
<label for="name">Name your cloud (optional)</label>
<input type="text" name="name"><br>
<fieldset id="update-type">
<input type="radio" name="update" value="static" checked="yes">Static
<input type="radio" name="update" value="dynamic">Dynamic<br>
<p>A static cloud stays the same as you see it right now. A dynamic cloud will
update every time you visit it.</p> 
</fieldset>
<input type="hidden" name="data" value="{{ tagcloud_json|escape }}">
</form>
</div>

<div id="tagcloud_controls">
  <h4>Themes</h4>
  <h4>Color</h4>
  {{ tagcloud_form.start_color.label }}: <input type="text" maxlength="6" size="6" id="id_start_color" value="00ff00" />
  {{ tagcloud_form.end_color.label }}: <input type="text" maxlength="6" size="6" id="id_end_color" value="0000ff" />
  {{ tagcloud_form.color_steps.label }}: {{ tagcloud_form.color_steps }}
      
  <h4>{{ tagcloud_form.max_words.label }}: <input type="range"  min="0" max="{{ max_words_max }}" /></h3>
  <h4 class="size-selector">Size:</h4>
    <label><input class="radio" type="radio" name="size" value="240x180"> Small</label>
    <label><input class="radio" type="radio" name="size" value="500x375"> Medium</label>
    <label><input class="radio" type="radio" name="size" value="1024x768"> Large</label>
  
  <h4>Custom Stop Words</h4>
</div>

<div id="tagcloud_wrapper">
{{ body|safe }}
</div>

<div class="clear">
</div>

<div id="infobox">
<div class=info" id="tagurl">
<p>This tag cloud was generated with the following (encoded) url:<br/>
<a href="{{ generator_url }}">{{ generator_url_display|safe }}</a></p>
</div>
<div class="info">
Create a short url for this cloud and share! 
<button id="save-cloud">Save This Cloud</button>
<a href="save">Static</a> | <a href="">Dynamic</a> (for url-based clouds only)
</div>
</div>

{% endblock %}
